(()=>{"use strict";e=function(e,r){for(var t=["webgl","experimental-webgl","webkit-3d","moz-webgl"],n=null,a=0;a<t.length;++a){try{n=e.getContext(t[a],r)}catch(e){}if(n)break}return n};var e,r=(r,t,n)=>{n=n||function(e){var r=document.getElementsByTagName("body")[0];if(r){var t=window.WebGLRenderingContext?'It doesn\'t appear your computer can support WebGL.<br/><a href="http://get.webgl.org">Click here for more information.</a>':'This page requires a browser that supports WebGL.<br/><a href="http://get.webgl.org">Click here to upgrade your browser.</a>';e&&(t+="<br/><br/>Status: "+e),r.innerHTML=function(e){return'<div style="margin: auto; width:500px;z-index:10000;margin-top:20em;text-align:center;">'+e+"</div>"}(t)}},r.addEventListener&&r.addEventListener("webglcontextcreationerror",(function(e){n(e.statusMessage)}),!1);var a=e(r,t);return a||(window.WebGLRenderingContext,n("")),a},t=function(){var e={enable:{0:!0},disable:{0:!0},getParameter:{0:!0},drawArrays:{0:!0},drawElements:{0:!0,2:!0},createShader:{0:!0},getShaderParameter:{1:!0},getProgramParameter:{1:!0},getVertexAttrib:{1:!0},vertexAttribPointer:{2:!0},bindTexture:{0:!0},activeTexture:{0:!0},getTexParameter:{0:!0,1:!0},texParameterf:{0:!0,1:!0},texParameteri:{0:!0,1:!0,2:!0},texImage2D:{0:!0,2:!0,6:!0,7:!0},texSubImage2D:{0:!0,6:!0,7:!0},copyTexImage2D:{0:!0,2:!0},copyTexSubImage2D:{0:!0},generateMipmap:{0:!0},bindBuffer:{0:!0},bufferData:{0:!0,2:!0},bufferSubData:{0:!0},getBufferParameter:{0:!0,1:!0},pixelStorei:{0:!0,1:!0},readPixels:{4:!0,5:!0},bindRenderbuffer:{0:!0},bindFramebuffer:{0:!0},checkFramebufferStatus:{0:!0},framebufferRenderbuffer:{0:!0,1:!0,2:!0},framebufferTexture2D:{0:!0,1:!0,2:!0},getFramebufferAttachmentParameter:{0:!0,1:!0,2:!0},getRenderbufferParameter:{0:!0,1:!0},renderbufferStorage:{0:!0,1:!0},clear:{0:!0},depthFunc:{0:!0},blendFunc:{0:!0,1:!0},blendFuncSeparate:{0:!0,1:!0,2:!0,3:!0},blendEquation:{0:!0},blendEquationSeparate:{0:!0,1:!0},stencilFunc:{0:!0},stencilFuncSeparate:{0:!0,1:!0},stencilMaskSeparate:{0:!0},stencilOp:{0:!0,1:!0,2:!0},stencilOpSeparate:{0:!0,1:!0,2:!0,3:!0},cullFace:{0:!0},frontFace:{0:!0}},r=null;function t(e){if(null==r)for(var t in r={},e)"number"==typeof e[t]&&(r[e[t]]=t)}function n(){if(null==r)throw"WebGLDebugUtils.init(ctx) not called"}function a(e){n();var t=r[e];return void 0!==t?t:"*UNKNOWN WebGL ENUM (0x"+e.toString(16)+")"}function o(r,t,n){var o=e[r];return void 0!==o&&o[t]?a(n):n.toString()}function i(e){var r=e.getParameter(e.MAX_VERTEX_ATTRIBS),t=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,t);for(var n=0;n<r;++n)e.disableVertexAttribArray(n),e.vertexAttribPointer(n,4,e.FLOAT,!1,0,0),e.vertexAttrib1f(n,0);e.deleteBuffer(t);var a=e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS);for(n=0;n<a;++n)e.activeTexture(e.TEXTURE0+n),e.bindTexture(e.TEXTURE_CUBE_MAP,null),e.bindTexture(e.TEXTURE_2D,null);for(e.activeTexture(e.TEXTURE0),e.useProgram(null),e.bindBuffer(e.ARRAY_BUFFER,null),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,null),e.bindFramebuffer(e.FRAMEBUFFER,null),e.bindRenderbuffer(e.RENDERBUFFER,null),e.disable(e.BLEND),e.disable(e.CULL_FACE),e.disable(e.DEPTH_TEST),e.disable(e.DITHER),e.disable(e.SCISSOR_TEST),e.blendColor(0,0,0,0),e.blendEquation(e.FUNC_ADD),e.blendFunc(e.ONE,e.ZERO),e.clearColor(0,0,0,0),e.clearDepth(1),e.clearStencil(-1),e.colorMask(!0,!0,!0,!0),e.cullFace(e.BACK),e.depthFunc(e.LESS),e.depthMask(!0),e.depthRange(0,1),e.frontFace(e.CCW),e.hint(e.GENERATE_MIPMAP_HINT,e.DONT_CARE),e.lineWidth(1),e.pixelStorei(e.PACK_ALIGNMENT,4),e.pixelStorei(e.UNPACK_ALIGNMENT,4),e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,!1),e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),e.UNPACK_COLORSPACE_CONVERSION_WEBGL&&e.pixelStorei(e.UNPACK_COLORSPACE_CONVERSION_WEBGL,e.BROWSER_DEFAULT_WEBGL),e.polygonOffset(0,0),e.sampleCoverage(1,!1),e.scissor(0,0,e.canvas.width,e.canvas.height),e.stencilFunc(e.ALWAYS,0,4294967295),e.stencilMask(4294967295),e.stencilOp(e.KEEP,e.KEEP,e.KEEP),e.viewport(0,0,e.canvas.clientWidth,e.canvas.clientHeight),e.clear(e.COLOR_BUFFER_BIT|e.DEPTH_BUFFER_BIT|e.STENCIL_BUFFER_BIT);e.getError(););}return{init:t,mightBeEnum:function(e){return n(),void 0!==r[e]},glEnumToString:a,glFunctionArgToString:o,makeDebugContext:function(e,r){t(e),r=r||function(e,r,t){for(var n,i="",u=0;u<t.length;++u)i+=(0==u?"":", ")+o(r,u,t[u]);n="WebGL error "+a(e)+" in "+r+"("+i+")",window.console&&window.console.log&&window.console.log(n)};var n={};function i(e,t){return function(){var a=e[t].apply(e,arguments),o=e.getError();return 0!=o&&(n[o]=!0,r(o,t,arguments)),a}}var u={};for(var l in e)"function"==typeof e[l]?u[l]=i(e,l):u[l]=e[l];return u.getError=function(){for(var r in n)if(n[r])return n[r]=!1,r;return e.NO_ERROR},u},makeLostContextSimulatingContext:function(e){var r={},t=1,n=!1,a=[],o=void 0,u=void 0,l=void 0,f={};function c(e){for(var r=0;r<e.length;++r){var n=e[r];if((a=n)instanceof WebGLBuffer||a instanceof WebGLFramebuffer||a instanceof WebGLProgram||a instanceof WebGLRenderbuffer||a instanceof WebGLShader||a instanceof WebGLTexture)return n.__webglDebugContextLostId__==t}var a;return!0}function s(e,r){var t=e[r];return function(){if(!n){if(!c(arguments))return void(f[e.INVALID_OPERATION]=!0);var r=t.apply(e,arguments);return r}}}for(var d in e)"function"==typeof e[d]?r[d]=s(e,d):r[d]=e[d];function g(e){return{statusMessage:e}}r.loseContext=function(){if(!n){for(n=!0,++t;e.getError(););!function(){for(var e=Object.keys(f),r=0;r<e.length;++r)delete glErrorShdow_[e]}(),f[e.CONTEXT_LOST_WEBGL]=!0,setTimeout((function(){o&&o(g("context lost"))}),0)}},r.restoreContext=function(){if(n){if(!u)throw"You can not restore the context without a listener";setTimeout((function(){if(function(){for(var r=0;r<a.length;++r){var t=a[r];t instanceof WebGLBuffer?e.deleteBuffer(t):t instanceof WebctxFramebuffer?e.deleteFramebuffer(t):t instanceof WebctxProgram?e.deleteProgram(t):t instanceof WebctxRenderbuffer?e.deleteRenderbuffer(t):t instanceof WebctxShader?e.deleteShader(t):t instanceof WebctxTexture&&e.deleteTexture(t)}}(),i(e),n=!1,u){var r=u;u=l,l=void 0,r(g("context restored"))}}),0)}},r.getError=function(){if(!n)for(;r=e.getError();)f[r]=!0;for(var r in f)if(f[r])return delete f[r],r;return e.NO_ERROR};for(var m=["createBuffer","createFramebuffer","createProgram","createRenderbuffer","createShader","createTexture"],b=0;b<m.length;++b)r[S=m[b]]=function(r){return function(){if(n)return null;var o=r.apply(e,arguments);return o.__webglDebugContextLostId__=t,a.push(o),o}}(e[S]);var v=["getActiveAttrib","getActiveUniform","getBufferParameter","getContextAttributes","getAttachedShaders","getFramebufferAttachmentParameter","getParameter","getProgramParameter","getProgramInfoLog","getRenderbufferParameter","getShaderParameter","getShaderInfoLog","getShaderSource","getTexParameter","getUniform","getUniformLocation","getVertexAttrib"];for(b=0;b<v.length;++b)r[S=v[b]]=function(r){return function(){return n?null:r.apply(e,arguments)}}(r[S]);var E,h=["isBuffer","isEnabled","isFramebuffer","isProgram","isRenderbuffer","isShader","isTexture"];for(b=0;b<h.length;++b){var S;r[S=h[b]]=function(r){return function(){return!n&&r.apply(e,arguments)}}(r[S])}function A(e){return"function"==typeof e?e:function(r){e.handleEvent(r)}}return r.checkFramebufferStatus=(E=r.checkFramebufferStatus,function(){return n?e.FRAMEBUFFER_UNSUPPORTED:E.apply(e,arguments)}),r.getAttribLocation=function(r){return function(){return n?-1:r.apply(e,arguments)}}(r.getAttribLocation),r.getVertexAttribOffset=function(r){return function(){return n?0:r.apply(e,arguments)}}(r.getVertexAttribOffset),r.isContextLost=function(){return n},r.registerOnContextLostListener=function(e){o=A(e)},r.registerOnContextRestoredListener=function(e){n?l=A(e):u=A(e)},r},resetToInitialState:i}}();function n(e,r,t){var n=e.createShader(r);if(null==n)return console.log("unable to create shader"),null;if(e.shaderSource(n,t),e.compileShader(n),!e.getShaderParameter(n,e.COMPILE_STATUS)){var a=e.getShaderInfoLog(n);return console.log("Failed to compile shader: "+a),e.deleteShader(n),null}return n}const a=e=>{e.clearColor(0,0,0,1),e.clear(e.COLOR_BUFFER_BIT)};class o{constructor(e){var r=new Float32Array(3);e&&"object"==typeof e&&(r[0]=e[0],r[1]=e[1],r[2]=e[2]),this.elements=r}set(e){var r,t,n;if((t=e.elements)!==(n=this.elements)){for(r=0;r<3;++r)n[r]=t[r];return this}}add(e){for(var r=0;r<3;r++)this.elements[r]+=e.elements[r];return this}sub(e){for(var r=0;r<3;r++)this.elements[r]-=e.elements[r];return this}div(e){for(var r=0;r<3;r++)this.elements[r]/=e;return this}mul(e){for(var r=0;r<3;r++)this.elements[r]*=e;return this}static dot(e,r){let t=0;for(var n=0;n<3;n++)t+=e.elements[n]*r.elements[n];return t}static cross(e,r){let t=e.elements,n=r.elements,a=t[1]*n[2]-t[2]*n[1],i=-1*(t[0]*n[2]-t[2]*n[0]),u=t[0]*n[1]-t[1]*n[0];return new o([a,i,u])}magnitude(){let e=0;for(var r=0;r<3;r++)e+=this.elements[r]*this.elements[r];return e=Math.sqrt(e),e}normalize(){return this.div(this.magnitude()),this}}const i=(e,r,t)=>{let[n,a]=r.elements,[o,i,u]=t.elements;const l=new Float32Array([0,0,n/20,a/20]),f=e.createBuffer();if(!f)return console.error("Failed to create vertex buffer"),-1;e.bindBuffer(e.ARRAY_BUFFER,f),e.bufferData(e.ARRAY_BUFFER,l,e.STATIC_DRAW);const c=e.getAttribLocation(e.program,"aPosition");e.vertexAttribPointer(c,2,e.FLOAT,!1,0,0),e.enableVertexAttribArray(c);const s=e.getUniformLocation(e.program,"uColor");return e.uniform4f(s,o,i,u,1),e.drawArrays(e.LINES,0,2),0},u=e=>{a(e);let r=document.querySelector("#x1").value,t=document.querySelector("#y1").value,n=new o([r,t,0]),u=new o([1,0,0]),l=document.querySelector("#x2").value,f=document.querySelector("#y2").value,c=new o([l,f,0]),s=new o([0,0,1]);return i(e,n,u),i(e,c,s),[n,c]},l=(()=>{const e=document.getElementById("webgl");if(!e)return console.log("Failed to retrieve the <canvas> element"),!1;const o=function(e,n){var a=r(e);return a?((arguments.length<2||n)&&(a=t.makeDebugContext(a)),a):null}(e);if(o){if(function(e,r,t){var a=function(e,r,t){var a=n(e,e.VERTEX_SHADER,r),o=n(e,e.FRAGMENT_SHADER,t);if(!a||!o)return null;var i=e.createProgram();if(!i)return null;if(e.attachShader(i,a),e.attachShader(i,o),e.linkProgram(i),!e.getProgramParameter(i,e.LINK_STATUS)){var u=e.getProgramInfoLog(i);return console.log("Failed to link program: "+u),e.deleteProgram(i),e.deleteShader(o),e.deleteShader(a),null}return i}(e,r,t);return a?(e.useProgram(a),e.program=a,!0):(console.log("Failed to create program"),!1)}(o,"#define GLSLIFY 1\nattribute vec4 aPosition;\n\nvoid main() {\n  gl_Position = aPosition;\n  gl_PointSize = 5.0;\n}","precision mediump float;\n#define GLSLIFY 1\n\nuniform vec4 uColor;\n\nvoid main() {\n  gl_FragColor = uColor;\n}"))return a(o),o;console.error("Failed to init shaders")}else console.error("Failed to retrieve context for the WebGL canvas")})();document.querySelector("#drawRequest").onclick=()=>{u(l)},document.querySelector("#operationRequest").onclick=()=>{(e=>{const[r,t]=u(e),n=document.querySelector("#op").value;let a=new o([0,1,0]);switch(n){case"add":r.add(t),i(e,r,a);break;case"sub":r.sub(t),i(e,r,a);break;case"mul":{let n=document.querySelector("#scalar").value;r.mul(n),i(e,r,a),t.mul(n),i(e,t,a);break}case"div":{let n=document.querySelector("#scalar").value;r.div(n),i(e,r,a),t.div(n),i(e,t,a);break}case"mag":console.log(`Magnitude of v1 is ${r.magnitude()}`),console.log(`Magnitude of v2 is ${t.magnitude()}`);break;case"norm":r.normalize(),i(e,r,a),t.normalize(),i(e,t,a);break;case"angle":{let e=r.magnitude(),n=t.magnitude(),a=Math.acos(o.dot(r,t)/e/n);a*=180/Math.PI,console.log(`The angle between v1 and v2 is: ${a}deg`);break}case"area":{let e=o.cross(r,t).magnitude();console.log("The area of the triangle spanned by v1 and v2 is: "+e/2);break}default:console.error("Something went wrong choosing an operation")}})(l)}})();