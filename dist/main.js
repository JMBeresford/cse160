(()=>{"use strict";class e{constructor(e){var t=new Float32Array(3);e&&"object"==typeof e&&(t[0]=e[0],t[1]=e[1],t[2]=e[2]),this.elements=t}set(e){var t,r,n;if((r=e.elements)!==(n=this.elements)){for(t=0;t<3;++t)n[t]=r[t];return this}}add(e){for(var t=0;t<3;t++)this.elements[t]+=e.elements[t];return this}sub(e){for(var t=0;t<3;t++)this.elements[t]-=e.elements[t];return this}div(e){for(var t=0;t<3;t++)this.elements[t]/=e;return this}mul(e){for(var t=0;t<3;t++)this.elements[t]*=e;return this}static dot(e,t){let r=0;for(var n=0;n<3;n++)r+=e.elements[n]*t.elements[n];return r}static cross(t,r){let n=t.elements,a=r.elements,o=n[1]*a[2]-n[2]*a[1],i=-1*(n[0]*a[2]-n[2]*a[0]),s=n[0]*a[1]-n[1]*a[0];return new e([o,i,s])}magnitude(){let e=0;for(var t=0;t<3;t++)e+=this.elements[t]*this.elements[t];return e=Math.sqrt(e),e}normalize(){return this.div(this.magnitude()),this}}class t{constructor(e){var t=new Float32Array(4);e&&"object"==typeof e&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3]),this.elements=t}}class r{constructor(e){var t,r,n;if(e&&"object"==typeof e&&e.hasOwnProperty("elements")){for(r=e.elements,n=new Float32Array(16),t=0;t<16;++t)n[t]=r[t];this.elements=n}else this.elements=new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}setIdentity(){var e=this.elements;return e[0]=1,e[4]=0,e[8]=0,e[12]=0,e[1]=0,e[5]=1,e[9]=0,e[13]=0,e[2]=0,e[6]=0,e[10]=1,e[14]=0,e[3]=0,e[7]=0,e[11]=0,e[15]=1,this}set(e){var t,r,n;if((r=e.elements)!==(n=this.elements)){for(t=0;t<16;++t)n[t]=r[t];return this}}multiply(e){var t,r,n,a,o,i,s,u;if(r=this.elements,n=this.elements,r===(a=e.elements))for(a=new Float32Array(16),t=0;t<16;++t)a[t]=r[t];for(t=0;t<4;t++)o=n[t],i=n[t+4],s=n[t+8],u=n[t+12],r[t]=o*a[0]+i*a[1]+s*a[2]+u*a[3],r[t+4]=o*a[4]+i*a[5]+s*a[6]+u*a[7],r[t+8]=o*a[8]+i*a[9]+s*a[10]+u*a[11],r[t+12]=o*a[12]+i*a[13]+s*a[14]+u*a[15];return this}concat(e){return this.multiply(e)}multiplyVector3(t){var r=this.elements,n=t.elements,a=new e,o=a.elements;return o[0]=n[0]*r[0]+n[1]*r[4]+n[2]*r[8]+r[12],o[1]=n[0]*r[1]+n[1]*r[5]+n[2]*r[9]+r[13],o[2]=n[0]*r[2]+n[1]*r[6]+n[2]*r[10]+r[14],a}multiplyVector4(e){var r=this.elements,n=e.elements,a=new t,o=a.elements;return o[0]=n[0]*r[0]+n[1]*r[4]+n[2]*r[8]+n[3]*r[12],o[1]=n[0]*r[1]+n[1]*r[5]+n[2]*r[9]+n[3]*r[13],o[2]=n[0]*r[2]+n[1]*r[6]+n[2]*r[10]+n[3]*r[14],o[3]=n[0]*r[3]+n[1]*r[7]+n[2]*r[11]+n[3]*r[15],a}transpose(){var e,t;return t=(e=this.elements)[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this}setInverseOf(e){var t,r,n,a,o;if(r=e.elements,n=this.elements,(a=new Float32Array(16))[0]=r[5]*r[10]*r[15]-r[5]*r[11]*r[14]-r[9]*r[6]*r[15]+r[9]*r[7]*r[14]+r[13]*r[6]*r[11]-r[13]*r[7]*r[10],a[4]=-r[4]*r[10]*r[15]+r[4]*r[11]*r[14]+r[8]*r[6]*r[15]-r[8]*r[7]*r[14]-r[12]*r[6]*r[11]+r[12]*r[7]*r[10],a[8]=r[4]*r[9]*r[15]-r[4]*r[11]*r[13]-r[8]*r[5]*r[15]+r[8]*r[7]*r[13]+r[12]*r[5]*r[11]-r[12]*r[7]*r[9],a[12]=-r[4]*r[9]*r[14]+r[4]*r[10]*r[13]+r[8]*r[5]*r[14]-r[8]*r[6]*r[13]-r[12]*r[5]*r[10]+r[12]*r[6]*r[9],a[1]=-r[1]*r[10]*r[15]+r[1]*r[11]*r[14]+r[9]*r[2]*r[15]-r[9]*r[3]*r[14]-r[13]*r[2]*r[11]+r[13]*r[3]*r[10],a[5]=r[0]*r[10]*r[15]-r[0]*r[11]*r[14]-r[8]*r[2]*r[15]+r[8]*r[3]*r[14]+r[12]*r[2]*r[11]-r[12]*r[3]*r[10],a[9]=-r[0]*r[9]*r[15]+r[0]*r[11]*r[13]+r[8]*r[1]*r[15]-r[8]*r[3]*r[13]-r[12]*r[1]*r[11]+r[12]*r[3]*r[9],a[13]=r[0]*r[9]*r[14]-r[0]*r[10]*r[13]-r[8]*r[1]*r[14]+r[8]*r[2]*r[13]+r[12]*r[1]*r[10]-r[12]*r[2]*r[9],a[2]=r[1]*r[6]*r[15]-r[1]*r[7]*r[14]-r[5]*r[2]*r[15]+r[5]*r[3]*r[14]+r[13]*r[2]*r[7]-r[13]*r[3]*r[6],a[6]=-r[0]*r[6]*r[15]+r[0]*r[7]*r[14]+r[4]*r[2]*r[15]-r[4]*r[3]*r[14]-r[12]*r[2]*r[7]+r[12]*r[3]*r[6],a[10]=r[0]*r[5]*r[15]-r[0]*r[7]*r[13]-r[4]*r[1]*r[15]+r[4]*r[3]*r[13]+r[12]*r[1]*r[7]-r[12]*r[3]*r[5],a[14]=-r[0]*r[5]*r[14]+r[0]*r[6]*r[13]+r[4]*r[1]*r[14]-r[4]*r[2]*r[13]-r[12]*r[1]*r[6]+r[12]*r[2]*r[5],a[3]=-r[1]*r[6]*r[11]+r[1]*r[7]*r[10]+r[5]*r[2]*r[11]-r[5]*r[3]*r[10]-r[9]*r[2]*r[7]+r[9]*r[3]*r[6],a[7]=r[0]*r[6]*r[11]-r[0]*r[7]*r[10]-r[4]*r[2]*r[11]+r[4]*r[3]*r[10]+r[8]*r[2]*r[7]-r[8]*r[3]*r[6],a[11]=-r[0]*r[5]*r[11]+r[0]*r[7]*r[9]+r[4]*r[1]*r[11]-r[4]*r[3]*r[9]-r[8]*r[1]*r[7]+r[8]*r[3]*r[5],a[15]=r[0]*r[5]*r[10]-r[0]*r[6]*r[9]-r[4]*r[1]*r[10]+r[4]*r[2]*r[9]+r[8]*r[1]*r[6]-r[8]*r[2]*r[5],0==(o=r[0]*a[0]+r[1]*a[4]+r[2]*a[8]+r[3]*a[12]))return this;for(o=1/o,t=0;t<16;t++)n[t]=a[t]*o;return this}invert(){return this.setInverseOf(this)}setOrtho(e,t,r,n,a,o){var i,s,u,l;if(e===t||r===n||a===o)throw"null frustum";return s=1/(t-e),u=1/(n-r),l=1/(o-a),(i=this.elements)[0]=2*s,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=2*u,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=-2*l,i[11]=0,i[12]=-(t+e)*s,i[13]=-(n+r)*u,i[14]=-(o+a)*l,i[15]=1,this}ortho(e,t,n,a,o,i){return this.concat((new r).setOrtho(e,t,n,a,o,i))}setFrustum(e,t,r,n,a,o){var i,s,u,l;if(e===t||n===r||a===o)throw"null frustum";if(a<=0)throw"near <= 0";if(o<=0)throw"far <= 0";return s=1/(t-e),u=1/(n-r),l=1/(o-a),(i=this.elements)[0]=2*a*s,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=2*a*u,i[6]=0,i[7]=0,i[8]=(t+e)*s,i[9]=(n+r)*u,i[10]=-(o+a)*l,i[11]=-1,i[12]=0,i[13]=0,i[14]=-2*a*o*l,i[15]=0,this}frustum(e,t,n,a,o,i){return this.concat((new r).setFrustum(e,t,n,a,o,i))}setPerspective(e,t,r,n){var a,o,i,s;if(r===n||0===t)throw"null frustum";if(r<=0)throw"near <= 0";if(n<=0)throw"far <= 0";if(e=Math.PI*e/180/2,0===(i=Math.sin(e)))throw"null frustum";return o=1/(n-r),s=Math.cos(e)/i,(a=this.elements)[0]=s/t,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=s,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=-(n+r)*o,a[11]=-1,a[12]=0,a[13]=0,a[14]=-2*r*n*o,a[15]=0,this}perspective(e,t,n,a){return this.concat((new r).setPerspective(e,t,n,a))}setScale(e,t,r){var n=this.elements;return n[0]=e,n[4]=0,n[8]=0,n[12]=0,n[1]=0,n[5]=t,n[9]=0,n[13]=0,n[2]=0,n[6]=0,n[10]=r,n[14]=0,n[3]=0,n[7]=0,n[11]=0,n[15]=1,this}scale(e,t,r){var n=this.elements;return n[0]*=e,n[4]*=t,n[8]*=r,n[1]*=e,n[5]*=t,n[9]*=r,n[2]*=e,n[6]*=t,n[10]*=r,n[3]*=e,n[7]*=t,n[11]*=r,this}setTranslate(e,t,r){var n=this.elements;return n[0]=1,n[4]=0,n[8]=0,n[12]=e,n[1]=0,n[5]=1,n[9]=0,n[13]=t,n[2]=0,n[6]=0,n[10]=1,n[14]=r,n[3]=0,n[7]=0,n[11]=0,n[15]=1,this}translate(e,t,r){var n=this.elements;return n[12]+=n[0]*e+n[4]*t+n[8]*r,n[13]+=n[1]*e+n[5]*t+n[9]*r,n[14]+=n[2]*e+n[6]*t+n[10]*r,n[15]+=n[3]*e+n[7]*t+n[11]*r,this}setRotate(e,t,r,n){var a,o,i,s,u,l,c,f,m,h,g,d;return e=Math.PI*e/180,a=this.elements,o=Math.sin(e),i=Math.cos(e),0!==t&&0===r&&0===n?(t<0&&(o=-o),a[0]=1,a[4]=0,a[8]=0,a[12]=0,a[1]=0,a[5]=i,a[9]=-o,a[13]=0,a[2]=0,a[6]=o,a[10]=i,a[14]=0,a[3]=0,a[7]=0,a[11]=0,a[15]=1):0===t&&0!==r&&0===n?(r<0&&(o=-o),a[0]=i,a[4]=0,a[8]=o,a[12]=0,a[1]=0,a[5]=1,a[9]=0,a[13]=0,a[2]=-o,a[6]=0,a[10]=i,a[14]=0,a[3]=0,a[7]=0,a[11]=0,a[15]=1):0===t&&0===r&&0!==n?(n<0&&(o=-o),a[0]=i,a[4]=-o,a[8]=0,a[12]=0,a[1]=o,a[5]=i,a[9]=0,a[13]=0,a[2]=0,a[6]=0,a[10]=1,a[14]=0,a[3]=0,a[7]=0,a[11]=0,a[15]=1):(1!==(s=Math.sqrt(t*t+r*r+n*n))&&(t*=u=1/s,r*=u,n*=u),l=1-i,c=t*r,f=r*n,m=n*t,h=t*o,g=r*o,d=n*o,a[0]=t*t*l+i,a[1]=c*l+d,a[2]=m*l-g,a[3]=0,a[4]=c*l-d,a[5]=r*r*l+i,a[6]=f*l+h,a[7]=0,a[8]=m*l+g,a[9]=f*l-h,a[10]=n*n*l+i,a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1),this}rotate=function(e,t,n,a){return this.concat((new r).setRotate(e,t,n,a))};setLookAt(e,t,r,n,a,o,i,s,u){var l,c,f,m,h,g,d,b,v,E,p,A;return c=n-e,f=a-t,m=o-r,g=(f*=h=1/Math.sqrt(c*c+f*f+m*m))*u-(m*=h)*s,d=m*i-(c*=h)*u,b=c*s-f*i,E=(d*=v=1/Math.sqrt(g*g+d*d+b*b))*m-(b*=v)*f,p=b*c-(g*=v)*m,A=g*f-d*c,(l=this.elements)[0]=g,l[1]=E,l[2]=-c,l[3]=0,l[4]=d,l[5]=p,l[6]=-f,l[7]=0,l[8]=b,l[9]=A,l[10]=-m,l[11]=0,l[12]=0,l[13]=0,l[14]=0,l[15]=1,this.translate(-e,-t,-r)}lookAt(e,t,n,a,o,i,s,u,l){return this.concat((new r).setLookAt(e,t,n,a,o,i,s,u,l))}dropShadow(e,t){var n=new r,a=n.elements,o=e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]*t[3];return a[0]=o-t[0]*e[0],a[1]=-t[1]*e[0],a[2]=-t[2]*e[0],a[3]=-t[3]*e[0],a[4]=-t[0]*e[1],a[5]=o-t[1]*e[1],a[6]=-t[2]*e[1],a[7]=-t[3]*e[1],a[8]=-t[0]*e[2],a[9]=-t[1]*e[2],a[10]=o-t[2]*e[2],a[11]=-t[3]*e[2],a[12]=-t[0]*e[3],a[13]=-t[1]*e[3],a[14]=-t[2]*e[3],a[15]=o-t[3]*e[3],this.concat(n)}dropShadowDirectionally=function(e,t,r,n,a,o,i,s,u){var l=n*e+a*t+o*r;return this.dropShadow([e,t,r,-l],[i,s,u,0])}}n=function(e,t){for(var r=["webgl","experimental-webgl","webkit-3d","moz-webgl"],n=null,a=0;a<r.length;++a){try{n=e.getContext(r[a],t)}catch(e){}if(n)break}return n};var n,a=(e,t,r)=>{r=r||function(e){var t=document.getElementsByTagName("body")[0];if(t){var r=window.WebGLRenderingContext?'It doesn\'t appear your computer can support WebGL.<br/><a href="http://get.webgl.org">Click here for more information.</a>':'This page requires a browser that supports WebGL.<br/><a href="http://get.webgl.org">Click here to upgrade your browser.</a>';e&&(r+="<br/><br/>Status: "+e),t.innerHTML=function(e){return'<div style="margin: auto; width:500px;z-index:10000;margin-top:20em;text-align:center;">'+e+"</div>"}(r)}},e.addEventListener&&e.addEventListener("webglcontextcreationerror",(function(e){r(e.statusMessage)}),!1);var a=n(e,t);return a||(window.WebGLRenderingContext,r("")),a},o=function(){var e={enable:{0:!0},disable:{0:!0},getParameter:{0:!0},drawArrays:{0:!0},drawElements:{0:!0,2:!0},createShader:{0:!0},getShaderParameter:{1:!0},getProgramParameter:{1:!0},getVertexAttrib:{1:!0},vertexAttribPointer:{2:!0},bindTexture:{0:!0},activeTexture:{0:!0},getTexParameter:{0:!0,1:!0},texParameterf:{0:!0,1:!0},texParameteri:{0:!0,1:!0,2:!0},texImage2D:{0:!0,2:!0,6:!0,7:!0},texSubImage2D:{0:!0,6:!0,7:!0},copyTexImage2D:{0:!0,2:!0},copyTexSubImage2D:{0:!0},generateMipmap:{0:!0},bindBuffer:{0:!0},bufferData:{0:!0,2:!0},bufferSubData:{0:!0},getBufferParameter:{0:!0,1:!0},pixelStorei:{0:!0,1:!0},readPixels:{4:!0,5:!0},bindRenderbuffer:{0:!0},bindFramebuffer:{0:!0},checkFramebufferStatus:{0:!0},framebufferRenderbuffer:{0:!0,1:!0,2:!0},framebufferTexture2D:{0:!0,1:!0,2:!0},getFramebufferAttachmentParameter:{0:!0,1:!0,2:!0},getRenderbufferParameter:{0:!0,1:!0},renderbufferStorage:{0:!0,1:!0},clear:{0:!0},depthFunc:{0:!0},blendFunc:{0:!0,1:!0},blendFuncSeparate:{0:!0,1:!0,2:!0,3:!0},blendEquation:{0:!0},blendEquationSeparate:{0:!0,1:!0},stencilFunc:{0:!0},stencilFuncSeparate:{0:!0,1:!0},stencilMaskSeparate:{0:!0},stencilOp:{0:!0,1:!0,2:!0},stencilOpSeparate:{0:!0,1:!0,2:!0,3:!0},cullFace:{0:!0},frontFace:{0:!0}},t=null;function r(e){if(null==t)for(var r in t={},e)"number"==typeof e[r]&&(t[e[r]]=r)}function n(){if(null==t)throw"WebGLDebugUtils.init(ctx) not called"}function a(e){n();var r=t[e];return void 0!==r?r:"*UNKNOWN WebGL ENUM (0x"+e.toString(16)+")"}function o(t,r,n){var o=e[t];return void 0!==o&&o[r]?a(n):n.toString()}function i(e){var t=e.getParameter(e.MAX_VERTEX_ATTRIBS),r=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,r);for(var n=0;n<t;++n)e.disableVertexAttribArray(n),e.vertexAttribPointer(n,4,e.FLOAT,!1,0,0),e.vertexAttrib1f(n,0);e.deleteBuffer(r);var a=e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS);for(n=0;n<a;++n)e.activeTexture(e.TEXTURE0+n),e.bindTexture(e.TEXTURE_CUBE_MAP,null),e.bindTexture(e.TEXTURE_2D,null);for(e.activeTexture(e.TEXTURE0),e.useProgram(null),e.bindBuffer(e.ARRAY_BUFFER,null),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,null),e.bindFramebuffer(e.FRAMEBUFFER,null),e.bindRenderbuffer(e.RENDERBUFFER,null),e.disable(e.BLEND),e.disable(e.CULL_FACE),e.disable(e.DEPTH_TEST),e.disable(e.DITHER),e.disable(e.SCISSOR_TEST),e.blendColor(0,0,0,0),e.blendEquation(e.FUNC_ADD),e.blendFunc(e.ONE,e.ZERO),e.clearColor(0,0,0,0),e.clearDepth(1),e.clearStencil(-1),e.colorMask(!0,!0,!0,!0),e.cullFace(e.BACK),e.depthFunc(e.LESS),e.depthMask(!0),e.depthRange(0,1),e.frontFace(e.CCW),e.hint(e.GENERATE_MIPMAP_HINT,e.DONT_CARE),e.lineWidth(1),e.pixelStorei(e.PACK_ALIGNMENT,4),e.pixelStorei(e.UNPACK_ALIGNMENT,4),e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,!1),e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),e.UNPACK_COLORSPACE_CONVERSION_WEBGL&&e.pixelStorei(e.UNPACK_COLORSPACE_CONVERSION_WEBGL,e.BROWSER_DEFAULT_WEBGL),e.polygonOffset(0,0),e.sampleCoverage(1,!1),e.scissor(0,0,e.canvas.width,e.canvas.height),e.stencilFunc(e.ALWAYS,0,4294967295),e.stencilMask(4294967295),e.stencilOp(e.KEEP,e.KEEP,e.KEEP),e.viewport(0,0,e.canvas.clientWidth,e.canvas.clientHeight),e.clear(e.COLOR_BUFFER_BIT|e.DEPTH_BUFFER_BIT|e.STENCIL_BUFFER_BIT);e.getError(););}return{init:r,mightBeEnum:function(e){return n(),void 0!==t[e]},glEnumToString:a,glFunctionArgToString:o,makeDebugContext:function(e,t){r(e),t=t||function(e,t,r){for(var n,i="",s=0;s<r.length;++s)i+=(0==s?"":", ")+o(t,s,r[s]);n="WebGL error "+a(e)+" in "+t+"("+i+")",window.console&&window.console.log&&window.console.log(n)};var n={};function i(e,r){return function(){var a=e[r].apply(e,arguments),o=e.getError();return 0!=o&&(n[o]=!0,t(o,r,arguments)),a}}var s={};for(var u in e)"function"==typeof e[u]?s[u]=i(e,u):s[u]=e[u];return s.getError=function(){for(var t in n)if(n[t])return n[t]=!1,t;return e.NO_ERROR},s},makeLostContextSimulatingContext:function(e){var t={},r=1,n=!1,a=[],o=void 0,s=void 0,u=void 0,l={};function c(e){for(var t=0;t<e.length;++t){var n=e[t];if((a=n)instanceof WebGLBuffer||a instanceof WebGLFramebuffer||a instanceof WebGLProgram||a instanceof WebGLRenderbuffer||a instanceof WebGLShader||a instanceof WebGLTexture)return n.__webglDebugContextLostId__==r}var a;return!0}function f(e,t){var r=e[t];return function(){if(!n){if(!c(arguments))return void(l[e.INVALID_OPERATION]=!0);var t=r.apply(e,arguments);return t}}}for(var m in e)"function"==typeof e[m]?t[m]=f(e,m):t[m]=e[m];function h(e){return{statusMessage:e}}t.loseContext=function(){if(!n){for(n=!0,++r;e.getError(););!function(){for(var e=Object.keys(l),t=0;t<e.length;++t)delete glErrorShdow_[e]}(),l[e.CONTEXT_LOST_WEBGL]=!0,setTimeout((function(){o&&o(h("context lost"))}),0)}},t.restoreContext=function(){if(n){if(!s)throw"You can not restore the context without a listener";setTimeout((function(){if(function(){for(var t=0;t<a.length;++t){var r=a[t];r instanceof WebGLBuffer?e.deleteBuffer(r):r instanceof WebctxFramebuffer?e.deleteFramebuffer(r):r instanceof WebctxProgram?e.deleteProgram(r):r instanceof WebctxRenderbuffer?e.deleteRenderbuffer(r):r instanceof WebctxShader?e.deleteShader(r):r instanceof WebctxTexture&&e.deleteTexture(r)}}(),i(e),n=!1,s){var t=s;s=u,u=void 0,t(h("context restored"))}}),0)}},t.getError=function(){if(!n)for(;t=e.getError();)l[t]=!0;for(var t in l)if(l[t])return delete l[t],t;return e.NO_ERROR};for(var g=["createBuffer","createFramebuffer","createProgram","createRenderbuffer","createShader","createTexture"],d=0;d<g.length;++d)t[p=g[d]]=function(t){return function(){if(n)return null;var o=t.apply(e,arguments);return o.__webglDebugContextLostId__=r,a.push(o),o}}(e[p]);var b=["getActiveAttrib","getActiveUniform","getBufferParameter","getContextAttributes","getAttachedShaders","getFramebufferAttachmentParameter","getParameter","getProgramParameter","getProgramInfoLog","getRenderbufferParameter","getShaderParameter","getShaderInfoLog","getShaderSource","getTexParameter","getUniform","getUniformLocation","getVertexAttrib"];for(d=0;d<b.length;++d)t[p=b[d]]=function(t){return function(){return n?null:t.apply(e,arguments)}}(t[p]);var v,E=["isBuffer","isEnabled","isFramebuffer","isProgram","isRenderbuffer","isShader","isTexture"];for(d=0;d<E.length;++d){var p;t[p=E[d]]=function(t){return function(){return!n&&t.apply(e,arguments)}}(t[p])}function A(e){return"function"==typeof e?e:function(t){e.handleEvent(t)}}return t.checkFramebufferStatus=(v=t.checkFramebufferStatus,function(){return n?e.FRAMEBUFFER_UNSUPPORTED:v.apply(e,arguments)}),t.getAttribLocation=function(t){return function(){return n?-1:t.apply(e,arguments)}}(t.getAttribLocation),t.getVertexAttribOffset=function(t){return function(){return n?0:t.apply(e,arguments)}}(t.getVertexAttribOffset),t.isContextLost=function(){return n},t.registerOnContextLostListener=function(e){o=A(e)},t.registerOnContextRestoredListener=function(e){n?u=A(e):s=A(e)},t},resetToInitialState:i}}();function i(e,t,r){var n=e.createShader(t);if(null==n)return console.log("unable to create shader"),null;if(e.shaderSource(n,r),e.compileShader(n),!e.getShaderParameter(n,e.COMPILE_STATUS)){var a=e.getShaderInfoLog(n);return console.log("Failed to compile shader: "+a),e.deleteShader(n),null}return n}const s=e=>{e.clearColor(0,0,0,1),e.clear(e.COLOR_BUFFER_BIT)},u=(e,t,r)=>{switch(t){case"triangle":var n=new Float32Array([0,.5,-.5,-.5,.5,-.5]);break;case"square":n=new Float32Array([-.5,.5,-.5,-.5,.5,.5,.5,-.5]);break;case"circle":{let e=[0,0],t=0;for(var a=0;a<=r;a++)e.push(Math.cos(t)/2),e.push(Math.sin(t)/2),t+=2*Math.PI/r;n=new Float32Array(e);break}}e.bufferData(e.ARRAY_BUFFER,n,e.DYNAMIC_DRAW);const o=e.getAttribLocation(e.program,"aPosition");e.vertexAttribPointer(o,2,e.FLOAT,!1,0,0),e.enableVertexAttribArray(o),n=null},l=e=>{let t=document.getElementById("shape").value,r=document.getElementById("scale").value,n=parseInt(document.getElementById("segments").value),a=e.offsetX/400*2-1,o=-(e.offsetY/400*2-1),i=document.getElementById("red").value,s=document.getElementById("green").value,u=document.getElementById("blue").value;m.shapes.push(t),m.scales.push(r),m.segments.push(n),m.clicks.push(a),m.clicks.push(o),m.colors.push(i),m.colors.push(s),m.colors.push(u)},c=e=>{if(m.shapes.length>0){const i=e.getUniformLocation(e.program,"uScaleMatrix"),l=e.getUniformLocation(e.program,"uTranslationMatrix"),c=e.getUniformLocation(e.program,"uColor"),f=e.getUniformLocation(e.program,"uRotationMatrix");var t=new r;let h=new r,g=new r;s(e);var n=m.shapes[0],a=m.segments[0];u(e,n,a);for(var o=0;o<m.shapes.length;o++){n!==m.shapes[o]&&(n=m.shapes[o],u(e,n,a)),a!==m.segments[o]&&(a=m.segments[o],u(e,n,a));let r=1;switch(m.funk&&(r=Math.sin(Date.now()/250)),g.setRotate(360*r,0,0,1),h.setScale(m.scales[o]*Math.abs(r),m.scales[o]*Math.abs(r),0),t.setTranslate(m.clicks[2*o],m.clicks[2*o+1],0),e.uniformMatrix4fv(i,!1,h.elements),e.uniformMatrix4fv(f,!1,g.elements),e.uniformMatrix4fv(l,!1,t.elements),e.uniform3f(c,m.colors[3*o],m.colors[3*o+1],m.colors[3*o+2]),n){case"triangle":e.drawArrays(e.TRIANGLES,0,3);break;case"square":e.drawArrays(e.TRIANGLE_STRIP,0,4);break;case"circle":e.drawArrays(e.TRIANGLE_FAN,0,m.segments[o]+2)}}h=null,t=null}requestAnimationFrame((()=>{c(e)}))},f=(()=>{const e=document.getElementById("webgl");if(!e)return console.log("Failed to retrieve the <canvas> element"),!1;const t=function(e,t){var r=a(e);return r?((arguments.length<2||t)&&(r=o.makeDebugContext(r)),r):null}(e);if(t){if(function(e,t,r){var n=function(e,t,r){var n=i(e,e.VERTEX_SHADER,t),a=i(e,e.FRAGMENT_SHADER,r);if(!n||!a)return null;var o=e.createProgram();if(!o)return null;if(e.attachShader(o,n),e.attachShader(o,a),e.linkProgram(o),!e.getProgramParameter(o,e.LINK_STATUS)){var s=e.getProgramInfoLog(o);return console.log("Failed to link program: "+s),e.deleteProgram(o),e.deleteShader(a),e.deleteShader(n),null}return o}(e,t,r);return n?(e.useProgram(n),e.program=n,!0):(console.log("Failed to create program"),!1)}(t,"#define GLSLIFY 1\nattribute vec4 aPosition;\n\nuniform mat4 uTranslationMatrix;\nuniform mat4 uScaleMatrix;\nuniform mat4 uRotationMatrix;\n\nvoid main() {\n\n  gl_Position = uTranslationMatrix * uScaleMatrix * uRotationMatrix * aPosition;\n}","precision mediump float;\n#define GLSLIFY 1\n\nuniform vec3 uColor;\n\nvoid main() {\n  gl_FragColor = vec4(uColor, 1.0);\n}"))return s(t),t;console.error("Failed to init shaders")}else console.error("Failed to retrieve context for the WebGL canvas")})(),m={clicks:[],scales:[],shapes:[],colors:[],segments:[],funk:!1};if(f){const e=f.createBuffer();f.bindBuffer(f.ARRAY_BUFFER,e),document.getElementById("clear").onclick=()=>{m.clicks=[],m.scales=[],m.segments=[],m.shapes=[],m.colors=[],s(f)},document.getElementById("funk").onclick=e=>{e.target.classList.toggle("enabled"),m.funk=!m.funk},document.getElementById("segments").onchange=e=>{document.querySelector(".segs").textContent=`Circle Segments (${e.target.value}):`},f.canvas.onclick=e=>l(e),f.canvas.onmousemove=e=>{1===e.buttons&&l(e)},c(f)}else console.error("There was an error getting the webGL context")})();